#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import MeshLinePlot kivy_garden.graph.MeshLinePlot
#:import isfile os.path.isfile



#circle maker for color settings
<ColorSelector>
    canvas:
        Color:
            rgba: root.color_digits
        Ellipse:
            size: self.size[0]-20,self.size[1]-20
            pos: self.x + 10, self.y + 10
	id: root.color_name



#for custom scrollview setting
<SettingScrollview>
	Label:
		text: root.value or ''
#for custom slider setting
<SettingSlider>
	Label:
		text: str(root.value) or ''
#for custom color picker setting
<SettingColorPicker>
	Label:
		text: str(root.value) or ''


<Separator@Widget>:
	canvas:
		Color:
			rgba: .9, .9, .9, .5
		Rectangle:
			pos: self.pos
			size: self.size

<Hseparator@Separator>:
	size_hint_y: None
	height: dp(2)


MainThread:

	#variables
	slider:slider
	cpugraph:cpugraph
	ramgraph:ramgraph

	#layout
	AnchorLayout:
		anchor_x: 'center'
		anchor_y: 'center'


		WallPaper:
			id: wallpp
			source: self.wallpaper_selection
			pos: self.pos
			allow_stretch: True
			keep_ratio: False
			size_hint_y: None
			size_hint_x: None
			height: root.height
			width: root.width

		#Main Screens
		ScreenManagement:
			transition: SlideTransition()
			id: st
			size_hint: 1, 1

			MusicScreen:
				name: 'music'
				id: musicscrn
				BoxLayout:
					orientation: 'vertical'
					size_hint: 1, 0.8
					pos_hint:{'x':0,'y':0.15}

					BoxLayout:
						orientation: 'horizontal'
						size_hint_x: 0.97
						#album artwork
						Image:
							#size_hint_x: 0.8
							id: album_art
							source: str(root.albumart)
							allow_stretch: True

						BoxLayout:
							orientation: 'vertical'
							#source selection
							BoxLayout:
								orientation:'horizontal'
								size_hint: 1,0.2
								Label:
									size_hint: 0.9,1
								BoxLayout:
									orientation:'vertical'
									size_hint: 0.1,1
									DynamicLabel:
										id: source_label
										multiplier: 0.22
										text_size: self.width , None
										text: root.source
										theme_text_color: 'Custom'
										text_color: app.theme_cls.primary_color
										halign: 'center'
										size_hint: 1,0.3
									MDIconButton:
										canvas:
											Color:
												rgba: .9, .9, .9, .1
											RoundedRectangle:
												pos: self.pos
												size: self.size
												radius: 100,100,100,100
										id: source_button
										icon: root.source.lower()
										theme_text_color: 'Custom'
										text_color: app.theme_cls.primary_color
										on_release: root.select_source(self)
										size_hint: 1,0.3




							#track name, artist, album
							DynamicLabel:
								id: bigscreenartist
								multiplier: 0.3
								text_size: self.width , None
								size_hint: 1,0.1
								valign: 'bottom'
								halign: 'center'
								theme_text_color: 'Custom'
								text_color: app.theme_cls.accent_color
								text: str(root.artist)
							DynamicLabel:
								id: bigscreentitle
								size_hint: 1,0.3
								multiplier: 0.8
								#text_size: self.width , None
								halign: 'center'
								theme_text_color: 'Custom'
								text_color: app.theme_cls.accent_color
								text: str(root.title)
							DynamicLabel:
								id: bigscreenalbum
								multiplier: 0.4
								text_size: self.width , None
								size_hint: 1,0.1
								valign: 'top'
								halign: 'center'
								theme_text_color: 'Custom'
								text_color: app.theme_cls.accent_color
								text: str(root.album)



							#Pause/Next/Back
							FloatLayout:
								orientation: 'horizontal'
								size_hint: 1, 0.3
								canvas:
									Color:
										rgba: .9, .9, .9, .1
									RoundedRectangle:
										pos: self.pos
										size: self.size
										radius: 100,100,100,100
								IconSizer:
									id: shuffle
									multiplier: 0.25
									pos_hint: {'x':0.03,'y':0.6}
									icon: 'shuffle'
									theme_text_color: 'Custom'
									text_color: app.theme_cls.primary_color
									on_press: root.control('shuffle')

								IconSizer:
									id: previous_track
									#multiplier variable declared in the IconSizer class
									multiplier: 1
									valign: 'top'
									icon: 'skip-previous'
									pos_hint: {'center_x':0.2,'center_y':0.5}
									theme_text_color: 'Custom'
									text_color: app.theme_cls.primary_color
									on_press: root.control('previous')

								IconSizer:
									id: playpause
									multiplier: 1
									valign: 'top'
									icon: 'play'
									pos_hint: {'center_x':0.5,'center_y':0.5}
									theme_text_color: 'Custom'
									text_color: app.theme_cls.primary_color
									on_press: root.control('playpause')

								IconSizer:
									id: next_track
									multiplier: 1
									valign: 'top'
									icon: 'skip-next'
									pos_hint: {'center_x':0.8,'center_y':0.5}
									theme_text_color: 'Custom'
									text_color: app.theme_cls.primary_color
									on_press: root.control('next')



					BoxLayout:
						orientation: 'horizontal'
						size_hint: 1,0.1

						MDLabel:
							id: songpos
							text: '0:00'
							halign: 'center'
							size_hint: 0.06,1
							theme_text_color: 'Custom'
							text_color: app.theme_cls.primary_color
							font_size: songpos.height/2.5

						MDProgressBar:
							id: slider
							size_hint: 0.88, 1
							cursor_size: 20, 20

						MDLabel:
							id: songlength
							size_hint: 0.06,1
							theme_text_color: 'Custom'
							text_color: app.theme_cls.primary_color
							text: '--:--'
							halign: 'center'
							font_size: songlength.height/2.5


							#Song Timers/Seek slider






			OBDIIScreen:
				name: 'obd'



			PerfScreen:
				name: 'perf'

				BoxLayout:
					size_hint: 0.95, 1
					orientation: 'vertical'

					BoxLayout:

						Graph:
							size_hint: 0.24, 1
							id: cpugraph

						Graph:
							size_hint: 0.24, 1
							id: ramgraph

						Graph:
							size_hint: 0.24, 1
							id: netupgraph

						Graph:
							size_hint: 0.24, 1
							id: netdowngraph

					BoxLayout:

						Button:
							id: CPU
							size_hint: 0.22, 1
							background_color: 0, 0, 0, 0

						Button:
							id: RAMpc
							size_hint: 0.22, 1
							background_color: 0, 0, 0, 0

						Button:
							id: netup
							size_hint: 0.22, 1
							background_color: 0, 0, 0, 0

						Button:
							id: netdown
							size_hint: 0.22, 1
							background_color: 0, 0, 0, 0

			SettingsScreen:
				icon: 'settings'
				name: 'settings'

				BoxLayout:
					id: settingsscreen


		Notify:

			MDBoxLayout:
				canvas.before:
					Color:
						rgba: 0.3,0.3,0.3,0.7
					RoundedRectangle:
						pos: self.pos
						size: self.size
						radius: [7,]
				id: notify
				orientation: 'vertical'
				pos_hint: {'x':1,'y':0.16}
				size_hint: .25, .09

				MDLabel:
					color: 1,1,1,1
					id: notifytitle
					halign: 'center'
					text_size: self.texture_size
					size_hint: 1, 0.5

				Hseparator

				MDLabel:
					color: 1,1,1,1
					id: notifymessage
					text_size: self.texture_size
					halign: 'center'
					valign: 'center'
		#Bottom Screen selectors
		Menu:
			anchor_x: 'left'
			anchor_y: 'bottom'
	        BoxLayout:
				canvas.before:
					Color:
						rgba: .3,.3,.3,0.75
					Rectangle:
						pos: self.pos
						size: self.size

				orientation:'horizontal'
	            id: tabs
	            size_hint: 1, 0.13

				IconButton:
					id: musicicon
					name: '1'
					orientation: 'vertical'
					size_hint: 0.25,1
					pos_hint: {'x': 0, 'y':0}
					on_release:
						root.slide_screen(self.name,'music')

					MDIconButton: #Music button
						id: music
						icon: 'music-note'
						size_hint: 1, .4
						user_font_size: self.y*2
						theme_text_color: 'Custom'
						text_color: app.theme_cls.accent_color
						on_release:
							root.slide_screen('1','music')

					MDLabel:
						size_hint: 1, 0.2
						id: musiclabel
						font_style: 'H6'
						halign: 'center'
						text: 'Music'
						color: app.theme_cls.accent_color

				IconButton:
					id: obdicon
					name: '2'
					orientation: 'vertical'
					size_hint: 0.25,1
					pos_hint: {'x': 0.25, 'y':0}
					on_release:
						root.slide_screen(self.name,'obd')

					MDIconButton: #OBDII button
						id: obd
						icon: 'car-cruise-control'
						size_hint: 1, .4
						user_font_size: self.y*2
						theme_text_color: 'Custom'
						text_color: app.theme_cls.primary_color
						on_release:
							root.slide_screen('2','obd')

					MDLabel:
						size_hint: 1, 0.2
						id: obdlabel
						font_style: 'H6'
						halign: 'center'
						text: 'OBD2'
						color: app.theme_cls.primary_color

				IconButton:
					id: perficon
					name: '3'
					orientation: 'vertical'
					size_hint: 0.25,1
					pos_hint: {'x': 0.5, 'y':0}
					on_release:
						root.slide_screen(self.name,'perf')

					MDIconButton: #PerfScreen
						id: perf
						icon: 'tune'
						size_hint: 1, .4
						user_font_size: self.y*2
						theme_text_color: 'Custom'
						text_color: app.theme_cls.primary_color
						on_release:
							root.slide_screen('3','perf')

					MDLabel:
						size_hint: 1, 0.2
						id: perflabel
						font_style: 'H6'
						halign: 'center'
						text: 'Performance'
						color: app.theme_cls.primary_color

				IconButton:
					id: settingsicon
					name: '4'
					orientation: 'vertical'
					size_hint: 0.25,1
					pos_hint: {'x': 0.75, 'y':0}
					on_release:
						root.slide_screen(self.name,'settings')

					MDIconButton:  #settings button
						id: settings
						icon: 'settings'
						size_hint: 1, .4
						user_font_size: self.y*2
						theme_text_color: 'Custom'
						text_color: app.theme_cls.primary_color
						on_release:
							root.slide_screen('4','settings')

					MDLabel:
						size_hint: 1, 0.2
						id: settingslabel
						font_style: 'H6'
						halign: 'center'
						text: 'Settings'
						color: app.theme_cls.primary_color


	VolumeSlider:
		id: volumecontrol
		size_hint: .04 , 0.78
		pos_hint: {'x': 0.96, 'y':0.2}
		orientation: 'vertical'

		MDSlider:
			hint_bg_color: app.theme_cls.accent_color
			hint_text_color: app.theme_cls.primary_color
			hint_radius: 2
			value: float(root.volstartup())
			orientation: 'vertical'
			id: volumeslider
			on_value: root.control(self.value)

	VoiceRecognizer:
		id: voicecontrol
		size_hint: 0.045,0.07
		pos_hint: {'center_x': 0.5,'y':0.93}
		canvas:
			Color:
				rgba: .9, .9, .9, .1
			RoundedRectangle:
				pos: self.pos
				size: self.size
				radius: 100,100,100,100
		halign: 'center'
		icon: 'microphone'
		theme_text_color: 'Custom'
		text_color: app.theme_cls.primary_color
		on_release: root.show_voice()
